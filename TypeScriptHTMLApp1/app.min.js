function update(){var n,t;for(drawRect(new vec2(0,0),new vec2(1024,768),"#FFFFFF"),drawText(new vec2(0,750),"Snap: "+(snap?"on":"off")),n=0;n<walls.length;n++)t=walls[n],drawLine(t.a,t.b)}function drawRect(n,t,i,r){typeof i=="undefined"&&(i="#000000"),typeof r=="undefined"&&(r=!1),ctx.fillStyle=i,r?ctx.strokeRect(n.x,n.y,t.x-n.x,t.y-n.y):ctx.fillRect(n.x,n.y,t.x-n.x,t.y-n.y)}function drawLine(n,t,i,r){typeof i=="undefined"&&(i="#000000"),typeof r=="undefined"&&(r=!1),ctx.beginPath(),ctx.moveTo(n.x,n.y),ctx.lineTo(t.x,t.y),ctx.fillStyle=i,ctx.closePath(),ctx.stroke()}function drawImage(n,t){ctx.drawImage(t,n.x,n.y)}function drawText(n,t,i){typeof i=="undefined"&&(i="#000000"),ctx.fillStyle=i,ctx.font="16px Arial",ctx.fillText(t,n.x,n.y)}function relMouseCoords(n){var i=0,r=0,u=0,f=0,t=this;do i+=t.offsetLeft-t.scrollLeft,r+=t.offsetTop-t.scrollTop;while(t=t.offsetParent);return u=n.pageX-i,f=n.pageY-r,{x:u,y:f}}var ctx,vec2=function(){function n(n,t){this.x=n,this.y=t}return n}(),snap=!1,Wall=function(){function n(){this.s=null,this.textureName="",this.portal=null,this.left=null,this.right=null}return n}(),walls=[],Sector=function(){function n(){}return n}(),sectors=[],currentWall;window.onkeydown=function(n){n.keyCode=="S".charCodeAt(0)&&(snap=!snap),n.keyCode==27&&(walls.splice(walls.indexOf(currentWall)),currentWall=null)},currentWall=null,window.oncontextmenu=function(n){n.preventDefault(),currentWall==null?(currentWall=new Wall,currentWall.a=relMouseCoords(n),currentWall.b=relMouseCoords(n),walls.push(currentWall)):(currentWall.b=relMouseCoords(n),currentWall=null)},window.onmousemove=function(n){if(currentWall!=null){var t=relMouseCoords(n);currentWall.b.x=n.clientX+document.body.scrollLeft,currentWall.b.y=n.clientY+document.body.scrollTop}},window.onload=function(){var t=document.getElementById("content"),n=document.getElementById("canvas");ctx=n.getContext("2d"),setInterval(update,17)}